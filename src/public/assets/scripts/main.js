(()=>{"use strict";var e,n={464:()=>{function e(e,n,t,i,s,r,a,o){var l,u="function"==typeof e?e.options:e;if(n&&(u.render=n,u.staticRenderFns=t,u._compiled=!0),i&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):s&&(l=o?function(){s.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(e,n){return l.call(n),d(e,n)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:u}}const n=e({props:{annotations:{type:Array,required:!0},url:{type:String,required:!0}},computed:{selectedAnnotations:function(){return this.annotations.filter((function(e){return e.selected}))},isDisabled:function(){return 1!==this.selectedAnnotations.length},href:function(){return this.url+this.selectedAnnotations[0].id}}},undefined,undefined,!1,null,null,null).exports;var t=biigle.$require("annotations.components.annotationCanvas"),i=biigle.$require("api.annotations"),s=biigle.$require("annotations.components.annotationsTabPlugins"),r=biigle.$require("messages").handleErrorResponse,a=biigle.$require("annotations.stores.images"),o=biigle.$require("labelTrees.components.labelTrees"),l=biigle.$require("core.mixins.loader"),u=biigle.$require("messages"),d=biigle.$require("core.components.sidebar"),c=biigle.$require("core.components.sidebarTab"),h=biigle.$require("core.components.typeahead"),f=biigle.$require("api.users");s&&(s.assistanceRequest=n);const b=e({components:{labelTrees:o,typeahead:h},data:function(){return{users:[],selectedUser:null,labelTrees:[]}},computed:{flatLabels:function(){var e=[];return this.labelTrees.forEach((function(n){Array.prototype.push.apply(e,n.labels)})),e},selectedLabels:function(){return this.flatLabels.filter((function(e){return e.selected}))},hasTooManySelectedLabels:function(){return this.selectedLabels.length>5},receiverId:function(){return this.selectedUser?this.selectedUser.id:""},receiverName:function(){return this.selectedUser?this.selectedUser.name:""}},methods:{close:function(){window.close()},loadUsers:function(){return f.query().then(this.usersLoaded,r)},usersLoaded:function(e){e.data.forEach((function(e){e.name=e.firstname+" "+e.lastname})),Vue.set(this,"users",e.data)},selectUser:function(e){this.selectedUser=e},clearSelectedUser:function(){this.selectedUser=null}},created:function(){var e=this,n=biigle.$require("ananas.oldLabels");if(Array.isArray(n)){var t={};n.forEach((function(e){t[e]=null})),this.flatLabels.forEach((function(e){t.hasOwnProperty(e.id)&&Vue.set(e,"selected",!0)}))}var i=this.loadUsers(),s=biigle.$require("ananas.oldReceiverId");s&&i.then((function(){for(var n=e.users.length-1;n>=0;n--)if(e.users[n].id==s)return void(e.selectedUser=e.users[n])})),this.labelTrees=biigle.$require("ananas.labelTrees")}},undefined,undefined,!1,null,null,null).exports,p=Vue.resource("api/v1/annotation-assistance-requests{/id}",{},{respond:{method:"PUT",url:"api/v1/annotation-assistance-requests{/token}"}});const g=e({mixins:[l],components:{sidebar:d,sidebarTab:c,annotationCanvas:t},data:function(){return{image:null,annotations:[],annotation:null}},methods:{setImageAndAnnotation:function(e){this.image=e,this.annotations.push(this.annotation)},focusAnnotation:function(){this.$refs.canvas.focusAnnotation(this.annotation,!0)},handleLoadingError:function(e){u.danger(e)}},created:function(){this.annotation=biigle.$require("ananas.annotation")},mounted:function(){this.startLoading(),a.fetchAndDrawImage(this.annotation.image_id).then(this.setImageAndAnnotation).then(this.focusAnnotation).catch(this.handleLoadingError).finally(this.finishLoading)}},undefined,undefined,!1,null,null,null).exports;const m=e({mixins:[g],data:function(){return{pickedLabel:null,responseText:"",closed:!1,errors:[],showMinimap:!0,token:""}},computed:{hasPickedLabel:function(){return null!==this.pickedLabel},hasResponseText:function(){return!!this.responseText},hasDisabledControls:function(){return this.closed||this.loading},hasErrors:function(){return this.errors.length>0}},methods:{pickLabel:function(e){this.hasDisabledControls||(this.pickedLabel===e?this.pickedLabel=null:this.pickedLabel=e)},submit:function(){var e={};this.hasPickedLabel&&(e.response_label_id=this.pickedLabel),this.hasResponseText&&(e.response_text=this.responseText),this.startLoading(),p.respond({token:this.token},e).finally(this.clearErrors).then(this.handleSuccess,this.handleError).finally(this.finishLoading)},handleSuccess:function(){this.closed=!0},clearErrors:function(e){return Vue.set(this,"errors",[]),e},handleError:function(e){for(var n in e.body)e.body.hasOwnProperty(n)&&this.errors.push(e.body[n][0])},checkForMobile:function(){window.innerWidth<1e3?this.showMinimap=!1:this.showMinimap=!0}},created:function(){this.checkForMobile(),window.addEventListener("resize",this.checkForMobile),this.token=biigle.$require("ananas.token")}},undefined,undefined,!1,null,null,null).exports;const v=e({mixins:[g],data:function(){return{existingLabels:[],userId:null,suggestedLabelId:null}},computed:{attachedSuggestedLabel:function(){for(var e=this.existingLabels,n=e.length-1;n>=0;n--)if(e[n].label_id===this.suggestedLabelId&&e[n].user_id===this.userId)return!0;return!1}},methods:{attach:function(){this.startLoading(),i.attachLabel({id:this.annotation.id},{label_id:this.suggestedLabelId,confidence:1}).then(this.handleAttachSuccess,r).finally(this.finishLoading)},handleAttachSuccess:function(){this.existingLabels.push({label_id:this.suggestedLabelId,user_id:this.userId})}},created:function(){this.existingLabels=biigle.$require("ananas.labels"),this.userId=biigle.$require("ananas.userId"),this.suggestedLabelId=biigle.$require("ananas.suggestedLabelId")}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("ananas-respond-container",m),biigle.$mount("ananas-show-container",v),biigle.$mount("create-ananas-form",b)},608:()=>{}},t={};function i(e){var s=t[e];if(void 0!==s)return s.exports;var r=t[e]={exports:{}};return n[e](r,r.exports,i),r.exports}i.m=n,e=[],i.O=(n,t,s,r)=>{if(!t){var a=1/0;for(u=0;u<e.length;u++){for(var[t,s,r]=e[u],o=!0,l=0;l<t.length;l++)(!1&r||a>=r)&&Object.keys(i.O).every((e=>i.O[e](t[l])))?t.splice(l--,1):(o=!1,r<a&&(a=r));o&&(e.splice(u--,1),n=s())}return n}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[t,s,r]},i.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={355:0,392:0};i.O.j=n=>0===e[n];var n=(n,t)=>{var s,r,[a,o,l]=t,u=0;for(s in o)i.o(o,s)&&(i.m[s]=o[s]);for(l&&l(i),n&&n(t);u<a.length;u++)r=a[u],i.o(e,r)&&e[r]&&e[r][0](),e[a[u]]=0;i.O()},t=self.webpackChunkbiigle_ananas=self.webpackChunkbiigle_ananas||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),i.O(void 0,[392],(()=>i(464)));var s=i.O(void 0,[392],(()=>i(608)));s=i.O(s)})();